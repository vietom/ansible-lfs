- name: Create the sources directory
  file:
    path: "{{ lfs_root }}/sources"
    state: directory
    mode: a+wt
    owner: root
    group: root

# urls and checksums are defined here instead of fetching from the lfs server as those need to be adapted in the future when downloads change
- name: include sources vars
  include_vars:
    file: sources.yml
    name: sources

- name: Download all tar files from the sources list
  get_url:
    url: "{{ item.url }}"
    dest: "{{ lfs_root }}/sources/{{ item.url.split('/')[-1] }}"
    checksum: "md5:{{ item.md5 }}"
  loop: "{{ sources['tars'] }}"

- name: Download all patch files from the sources list
  get_url:
    url: "{{ item.url }}"
    dest: "{{ lfs_root }}/sources/{{ item.url.split('/')[-1] }}"
    checksum: "md5:{{ item.md5 }}"
  loop: "{{ sources['patches'] }}"
